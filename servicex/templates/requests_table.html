{% from 'bootstrap/table.html' import render_table %}
{% from 'bootstrap/pagination.html' import render_pager %}
{% from 'bootstrap/pagination.html' import render_pagination %}


{#{{ render_table(transformation_requests }}#}

<table class="table">
  <thead class="thead-dark">
    <tr>
      <th scope="col">ID</th>
      {% if config['ENABLE_AUTH'] %}<th scope="col">Submitted by</th>{% endif %}
      <th scope="col">Submitted at</th>
      <th scope="col">Age</th>
      <th scope="col">Status</th>
      <th scope="col">Files completed</th>
      <th scope="col">Workers</th>
    </tr>
  </thead>
  <tbody>
  {% for req in transformation_requests %}
    <tr>
      <th scope="row" style="word-break: break-all">
        <a href="/transformation-request/{{ req.id }}">{{ req.title or "Default title" }}</a>
      </th>
      {% if config['ENABLE_AUTH'] %}<td>{{ req.submitter_name }}</td>{% endif %}
      <td>{{ req.submit_time.strftime("%Y-%m-%d %H:%M:%S") }}</td>
      <td>{{ humanize.naturaldelta(req.age) }}</td>
      <td>
        <div id="status-{{ req.request_id }}">
          {{ req.status }}
        </div>
      {% if req.incomplete %}
        <div class="progress" id="progress-{{ req.request_id }}">
          <div class="progress-bar progress-bar-striped progress-bar-animated" id="progress-bar-{{ req.request_id }}">
          </div>
        </div>
      {% endif %}
      </td>
      <td>
        <div>
          <span id="files-processed-{{ req.request_id }}">{{ humanize.intcomma(req.files_processed) }}</span> of {{ humanize.intcomma(req.files) }}</div>
        <div id="files-failed-{{ req.request_id }}">
          {% if req.files_failed %}({{ req.files_failed }} failed){% endif %}
        </div>
      </td>
      <td id="replicas-{{ req.request_id }}">-</td>
    </tr>
  {% endfor %}
  </tbody>
</table>
{% if transformation_requests %}
  {{ render_pagination(pagination, align='center') }}
{% endif %}
